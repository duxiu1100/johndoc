网络线下地址：10.180.10.80:9696

获取master的token
curl -X GET http://10.180.11.95:8181/rest/openapi/service/token?tenantId=dba4e5e4109f4807b605262740219131 -H "Content-Type: application/json"
{"result":{"token":"1898172307b14549af50acda1c8a1dc8","expire":1460683815000},"requestId":"7600bf0e-dde7-4a0c-abd1-8223b04bb22a","code":200}

将master加入租户的service角色
curl -X PUT http://10.180.11.95:8182/rest/extend/v1/roles/f8900ae7f0004ae0a6f0d3a159f86fbf -H "Content-Type: application/json" -H "X-Auth-Token: 1898172307b14549af50acda1c8a1dc8" -d '{"role": {"name": "member"}}'
{"role":{"name":"member"}}


获取master操作租户的token
curl -X GET http://10.180.11.95:8181/rest/openapi/tenant/token?serviceId=dba4e5e4109f4807b605262740219131\&tenantId=f8900ae7f0004ae0a6f0d3a159f86fbf
{"result":{"token":"21ac37fdcbea4bd3a1259effe2e263ea","expire":"1460683957000"},"requestId":"790d1cb2-a4ae-4831-840b-76acbccbed3b","code":200}

创建一个外网port
curl -X POST http://10.180.10.80:9696/v2.0/ports -H "Content-Type: application/json" -H "X-Auth-Token: 21ac37fdcbea4bd3a1259effe2e263ea" -d '{"port":{"vnetwork":"public","az":"xiaoshan1"}}'
{"port": {"status": "DOWN", "name": "", "allowed_address_pairs": [], "admin_state_up": true, "network_id": "5846d806-920a-4d02-849b-a92e3300f9dd", "tenant_id": "f8900ae7f0004ae0a6f0d3a159f86fbf", "device_owner": "", "mac_address": "fa:16:3e:fd:e0:47", "support_azs": ["xiaoshan1"], "fixed_ips": [{"subnet_id": "7f9f0a78-1b4c-4d8b-a1e1-2dde4ed90106", "ip_address": "115.236.127.57"}], "id": "91845965-36bb-45f4-b233-dba2882c8bad", "device_id": ""}}

curl -X GET http://10.180.10.80:9696/v2.0/subnets?id=92ed0eea-6414-4aea-ac75-56083e758310 -H "X-Auth-Token: fcc76bb4bf2a4d79a678309990527001" -H "Content-Type: application/json"
{"subnets": [{"name": "", "enable_dhcp": true, "network_id": "7780586f-cd4e-46bf-8e94-a39f5ac4b6d2", "tenant_id": "5116a55a1a91499986c20803a901f0a4", "dns_nameservers": [], "enable_dns": false, "allocation_pools": [{"start": "60.191.83.10", "end": "60.191.83.169"}], "host_routes": [{"nexthop": "60.191.83.1", "destination": "0.0.0.0/1", "order": 10}, {"nexthop": "60.191.83.1", "destination": "128.0.0.0/1", "order": 10}], "ip_version": 4, "gateway_ip": null, "cidr": "60.191.83.0/24", "id": "92ed0eea-6414-4aea-ac75-56083e758310"}]}

获取外网port的信息
curl -X GET http://10.180.10.80:9696/v2.0/ports/91845965-36bb-45f4-b233-dba2882c8bad -H "Content-Type: application/json" -H "X-Auth-Token: 21ac37fdcbea4bd3a1259effe2e263ea"
{"port": {"status": "DOWN", "filtered_ports": null, "name": "", "allowed_address_pairs": [], "admin_state_up": true, "prefer_rate": null, "tenant_id": "f8900ae7f0004ae0a6f0d3a159f86fbf", "extra_dhcp_opts": [], "max_rate": null, "network_id": "5846d806-920a-4d02-849b-a92e3300f9dd", "device_owner": "", "mac_address": "fa:16:3e:fd:e0:47", "port_security_enabled": null, "support_azs": ["xiaoshan1"], "fixed_ips": [{"subnet_id": "7f9f0a78-1b4c-4d8b-a1e1-2dde4ed90106", "ip_address": "115.236.127.57"}], "id": "91845965-36bb-45f4-b233-dba2882c8bad", "device_id": ""}}

删除一个网络port
curl -X DELETE http://10.180.10.80:9696/v2.0/ports/91845965-36bb-45f4-b233-dba2882c8bad -H "Content-Type: application/json" -H "X-Auth-Token: 21ac37fdcbea4bd3a1259effe2e263ea"

绑定port到云主机上
curl -X POST http://10.180.10.80:8774/v2/f8900ae7f0004ae0a6f0d3a159f86fbf/servers/8f8781e8-2624-4237-a1a5-2b6dcd639f96/os-interface -H "Content-Type: application/json" -H "X-Auth-Token: 21ac37fdcbea4bd3a1259effe2e263ea" -d '{"interfaceAttachment":{"port_id":"8b0e93c5-bff3-4bd6-a6bd-283b6071f576"}}'
{"interfaceAttachment": {"port_state": "ACTIVE", "fixed_ips": [{"subnet_id": "7f9f0a78-1b4c-4d8b-a1e1-2dde4ed90106", "ip_address": "115.236.127.82"}], "port_id": "8b0e93c5-bff3-4bd6-a6bd-283b6071f576", "net_id": "5846d806-920a-4d02-849b-a92e3300f9dd", "mac_addr": "fa:16:3e:02:54:ac"}}

查询虚拟机的port列表
curl -X GET http://10.180.10.80:8774/v2/f8900ae7f0004ae0a6f0d3a159f86fbf/servers/8f8781e8-2624-4237-a1a5-2b6dcd639f96/os-interface -H "Content-Type: application/json" -H "X-Auth-Token: 21ac37fdcbea4bd3a1259effe2e263ea"|python -m json.tool

卸载port
curl -X DELETE http://10.180.10.80:8774/v2/f8900ae7f0004ae0a6f0d3a159f86fbf/servers/8f8781e8-2624-4237-a1a5-2b6dcd639f96/os-interface/8b0e93c5-bff3-4bd6-a6bd-283b6071f576 -H "Content-Type: application/json" -H "X-Auth-Token: 21ac37fdcbea4bd3a1259effe2e263ea"

